import os
import shutil


MALICIOUS_EXTENSIONS = ['.exe', '.bat', '.cmd', '.vbs', '.scr', '.pif']
MALICIOUS_FILENAMES = ['malware', 'virus', 'trojan']


SCAN_DIRECTORY = './scan_directory'
QUARANTINE_DIRECTORY = './quarantine'

def scan_directory(directory):
    print(f"Escaneando o diretório: {directory}")
    for root, _, files in os.walk(directory):
        for file in files:
            file_path = os.path.join(root, file)
            if is_malicious(file):
                print(f'Arquivo malicioso detectado: {file_path}')
                quarantine_file(file_path)
            else:
                print(f'Arquivo limpo: {file_path}')

def is_malicious(file):
    file_name, file_extension = os.path.splitext(file)
    is_malicious_file = (file_extension.lower() in MALICIOUS_EXTENSIONS or 
            any(mal in file_name.lower() for mal in MALICIOUS_FILENAMES))
    print(f'Verificando arquivo: {file}, Malicioso: {is_malicious_file}')
    return is_malicious_file

def quarantine_file(file_path):
    if not os.path.exists(QUARANTINE_DIRECTORY):
        os.makedirs(QUARANTINE_DIRECTORY)
    destination = os.path.join(QUARANTINE_DIRECTORY, os.path.basename(file_path))
    shutil.move(file_path, destination)
    print(f'Arquivo movido para a quarentena: {destination}')

if __name__ == "__main__":
    scan_directory(SCAN_DIRECTORY)
    print('Escaneamento concluído.')
